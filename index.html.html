direccionSection.style.display = 'none';
    }
  });

  document.getElementById('imagen').addEventListener('change', function (e) {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function (e) {
        preview.src = e.target.result;
        preview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    }
  });

  form.addEventListener('submit', function(e) {
  e.preventDefault();

  const formData = new FormData(form);
  const pedido = {};

  formData.forEach((value, key) => {
    // Si es selección múltiple, lo convertimos en array
    if (pedido[key]) {
      if (!Array.isArray(pedido[key])) pedido[key] = [pedido[key]];
      pedido[key].push(value);
    } else {
      pedido[key] = value;
    }
  });

  // Generar número de orden
  const ordenID = 'ORD-' + Date.now();
  pedido.orden = ordenID;

  console.log('Pedido generado:', pedido);
const scriptURL = 'https://script.google.com/macros/s/AKfycbw7Bj5sJb_cRUnP9Y4RSxgqqGBsi1-H1q8-vEtpr5zCNnrbHcb6H-rznfKLAFZ22hGW/exec';
  fetch(scriptURL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(pedido)
  })
  .then(response => response.json())
  .then(data => {
    if(data.status === 'success') {
      alert(`🎉 Pedido enviado con éxito. Tu número de orden es: ${ordenID}`);
      form.reset();
      preview.style.display = 'none';
      direccionSection.style.display = 'none';
    } else {
      alert('Error en el servidor: ' + (data.message || 'Intenta de nuevo'));
    }
  })
  .catch(error => {
    alert('🚫 Error al enviar tu pedido. Por favor, escríbenos a través del botón ¿Necesitas ayuda? y con gusto te asistiremos..');
    console.error('Error:', error);
  });
});


</script>
</body>
</html>
